## 设置调度器钩子实战

#### 一、概念

在整个系统的运行时，系统都处于线程运行、中断触发 、响应中断、切换到其他线程，甚至是线程间的切换过程中，或者说系统的上下文切换是系统中最普遍的事件。有时用户可能会想知道在一个时刻发生了什么样的线程切换，可以通过调用下面的函数接口设置一个相应的钩子函数。在系统线程切换时，这个钩子函数将被调用：

> 函数原型声明：

![image-20220514152847847](C:/Users/ASUS/AppData/Roaming/Typora/typora-user-images/image-20220514152847847.png)

设置调度器钩子函数的输入参数如下表所示：

| **函数参数** | **描述**                   |
| ------------ | -------------------------- |
| hook         | 表示用户定义的钩子函数指针 |

#### 二、函数声明

钩子函数 hook() 的声明如下：

```
void hook(struct rt_thread* from, struct rt_thread* to);
```

调度器钩子函数 hook() 的输入参数如下表所示：

| **函数参数** | **描述**                           |
| ------------ | ---------------------------------- |
| from         | 表示系统所要切换出的线程控制块指针 |
| to           | 表示系统所要切换到的线程控制块指针 |

> 注：请仔细编写你的钩子函数，稍有不慎将很可能导致整个系统运行不正常（在这个钩子函数中，`基本上不允许调用系统 API，更不应该导致当前运行的上下文挂起`）。

